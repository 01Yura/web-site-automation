<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Selenoid and Configuration Access</title>
    <link rel="icon" type="image/png" href="../favicon.png" />
    <link rel="stylesheet" href="../assets/styles.css" />
    <script src="../assets/copy-code.js"></script>
    <style>
      /* Smaller font size for list items on this page */
      ul li,
      ol li {
        font-size: 0.95em;
      }
      /* Ensure nested lists inside tips match surrounding text size */
      .tips ul,
      .tips ul li {
        font-size: inherit;
      }
    </style>
  </head>
  <body>
    <div class="language-switcher">
      <a href="../index.html" class="lang-link">Home</a>
      <span class="lang-separator">|</span>
      <a href="../ru/selenoid.html" class="lang-link">RU</a>
      <span class="lang-separator">|</span>
      <a href="selenoid.html" class="lang-link active">EN</a>
    </div>

    <h1>Selenoid and Configuration Access</h1>

    <div class="warning">
      <strong>WARNING!</strong> I couldn't get Selenoid running on Windows 10
      with Docker Desktop (Docker Engine 26.1.4; after upgrading to 28.1.5 it
      worked) and on MacBook with M1 chip (Apple Silicon), although there's a
      workaround for Mac (<a
        href="https://gist.github.com/AlexRogalskiy/b266e960606dc565c22c3e6bfd9f48df"
        target="_blank"
        rel="noopener"
        >link</a
      >), but it only works for Chrome version 91. I managed to run it only on
      Linux (Ubuntu; it will probably work on other Linux distributions too), on
      Windows 11, and on newer MacBooks.
    </div>

    <ul>
      <li>
        Access to <strong>Selenoid</strong>:
        <a
          href="http://176.126.103.46:4444/status"
          target="_blank"
          rel="noopener"
          >view on page</a
        >
      </li>
      <li>
        Access to <strong>Selenoid UI</strong>:
        <a href="http://176.126.103.46:8080" target="_blank" rel="noopener"
          >view on page</a
        >
        (there is a thread limit: max 1; otherwise the server may crash due to low RAM)
      </li>
      <li>
        <strong>browsers.json</strong>:
        <a href="browsers.html">view on page</a>
      </li>
      <li>
        <strong>docker-compose.yml</strong> (Selenoid + UI):
        <a href="docker-compose.html">view on page</a>
      </li>
      <li>
        <strong>docker-compose.yml with video recording</strong>:
        <a href="docker-compose-video.html">view on page</a>
      </li>
    </ul>

    <div class="tips">
      <h1>Common Selenoid Setup and Autotest Launch Errors</h1>
      <ol>
        <li>
          <strong
            >Browser images specified in <code>browsers.json</code> are not
            downloaded.</strong
          >
          <ul>
            <li>
              Selenoid does not download them automatically, and tests don't
              start due to missing images. Download the required images
              manually.
            </li>
          </ul>
        </li>

        <li>
          <strong>Syntax errors in <code>browsers.json</code>.</strong>
          <ul>
            <li>
              For "chrome" and "opera" the <code>path</code> key in
              <code>browsers.json</code> must be <code>"/"</code>, not
              <code>"/wd/hub"</code>. For "firefox" keep <code>"/wd/hub"</code>.
              Be careful, otherwise the browser will not start.
            </li>
            <li>
              Typos in image name/version tag (often confusion in the placement
              of underscores or colons when specifying image version, ChatGPT is
              guilty of this). For example, instead of
              <code>selenoid/vnc_chrome:128.0</code> it's written
              <code>selenoid/vnc_chrome_128.0</code>.
            </li>
          </ul>
        </li>

        <li>
          <strong
            >Path errors in <code>docker-compose.yml</code> (volumes).</strong
          >
          <ul>
            <li>
              Due to incorrect paths, Selenoid can't see
              <code>browsers.json</code>, UI doesn't connect to Selenoid, and
              videos aren't written. Check directory mounting (paths specified
              in volumes) - this is a common error.
            </li>
          </ul>
        </li>

        <li>
          <strong>Video recording is configured incorrectly.</strong>
          <ul>
            <li>
              Essentially, in docker-compose.yml you just need to add an
              environment variable with an <u>absolute path</u> to the
              <code>video</code> folder:
              <pre>
environment:
  OVERRIDE_VIDEO_OUTPUT_DIR: /root/selenoid_with_video/video</pre
              >
              Here you can't use <code>${PWD}</code> or <code>./video</code> -
              an absolute path is required! You can read more about this in the
              official documentation:
              <a
                href="https://aerokube.com/selenoid/latest/#_video_recording"
                target="_blank"
                rel="noopener"
                >aerokube.com/selenoid … video_recording</a
              >.
            </li>
            <li>
              Often people forget to pre-download the recorder image:
              <code>docker pull selenoid/video-recorder:latest-release</code>.
              You do not need to add this image to
              <code>docker-compose.yml</code>; it will start automatically, the
              main thing is to download it once.
            </li>
            <li>
              People forget that you can't use headless mode:
              <pre>Configuration.headless = true;</pre>
            </li>
            It should be removed completely, or replaced with
            <pre>Configuration.headless = false;</pre>
            If there's no screen, there's nothing to record.
          </ul>
        </li>

        <li>
          <strong
            >Problems on Windows 10 (Docker Engine 26.1.4; after upgrading to
            28.1.5 it worked) and Mac with M1 chip.</strong
          >
          <ul>
            <li>
              Containers start, but the browser starts and immediately crashes.
              If you use Windows, update Docker; after upgrading to 28.1.5 it
              worked. For Mac, there are workaround options only for Chrome
              version 91 (
              <a
                href="https://gist.github.com/AlexRogalskiy/b266e960606dc565c22c3e6bfd9f48df"
                target="_blank"
                rel="noopener"
                >link</a
              >). Recommendation: use a Linux host or VM/VPS (e.g., Ubuntu
              Server 22.04, ≥10&nbsp;GB disk, ≥2&nbsp;GB RAM), a newer MacBook,
              or Windows 11.
            </li>
          </ul>
        </li>

        <li>
          <strong
            >Incorrect IP address of the tested application in tests.</strong
          >
          <ul>
            <li>
              In a container, you can't use <code>localhost</code> to access an
              application running outside the container - specify the real host
              IP address. <br />Correct example:
              <pre>Configuration.baseUrl = "http://192.168.0.127:3000";</pre>
              Incorrect example:
              <pre>Configuration.baseUrl = "http://localhost:3000";</pre>
              Here you must use an IP address, not localhost, because this URL
              is substituted into the browser address bar opened in the Docker
              container, and if you specify localhost, the container will think
              that the application is also running inside the same container,
              but it is not running in it.
            </li>
          </ul>
        </li>

        <li>
          <strong>Manual browser check in UI.</strong>
          <ul>
            <li>
              In general, after installing Selenoid, Selenoid UI and downloading
              browser images, you need to make sure that browsers can open at
              least manually, so that later, if something doesn't work, you
              understand whether it's a problem with tests or Selenoid
              configuration. For this, after starting Selenoid (docker-compose
              up -d), go to its ip_address:8080, at the top right there should
              be 2 CONNECTED labels, then go to the CAPABILITIES tab, select a
              browser from the dropdown list (if there's no list, then there's a
              problem with browsers.json or the path to it) and launch it
              manually. A browser window should appear. If it appears,
              congratulations - Selenoid is configured, now the main thing is to
              correctly write everything in the tests themselves.
            </li>
          </ul>
        </li>
      </ol>
    </div>
  </body>
</html>
