<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>docker-compose.yml - with video recording capability</title>
    <link rel="icon" type="image/png" href="../favicon.png" />
    <link rel="stylesheet" href="../assets/styles.css" />
    <script src="../assets/copy-code.js"></script>
  </head>
  <body>
    <div class="language-switcher">
      <a href="../index.html" class="lang-link">Home</a>
      <span class="lang-separator">|</span>
      <a href="../ru/docker-compose-video.html" class="lang-link">RU</a>
      <span class="lang-separator">|</span>
      <a href="docker-compose-video.html" class="lang-link active">EN</a>
    </div>

    <p class="back-link">
      <a href="selenoid.html">← На предыдущую страницу</a>
    </p>

    <h1>docker-compose.yml - with video recording capability</h1>

    <pre>
services:
  selenoid:
    image: aerokube/selenoid
    network_mode: bridge
    ports:
      - "4444:4444"
    volumes:
      - ${PWD}:/etc/selenoid
      - /var/run/docker.sock:/var/run/docker.sock
      - ${PWD}/video:/opt/selenoid/video
      - ${PWD}/logs:/opt/selenoid/logs
    environment:
      OVERRIDE_VIDEO_OUTPUT_DIR: /root/selenoid_with_video/video     #here the path to the video folder specified above must be absolute! ${PWD} won't work. As written in the official docs
    command:
      [
        "-conf", "/etc/selenoid/browsers.json",
        "-video-output-dir", "/opt/selenoid/video",
        "-log-output-dir", "/opt/selenoid/logs"
      ]

  selenoid-ui:
    container_name: selenoid-ui
    image: aerokube/selenoid-ui
    network_mode: bridge
    links:
      - selenoid
    ports:
      - "8080:8080"
    command: ["--selenoid-uri", "http://selenoid:4444"]</pre
    >

    <div class="warning">
      <strong>Important for video recording:</strong>
      <ul>
        <li>
          <strong
            >In the <code>environment</code> section, you must specify an
            absolute path!</strong
          >
          The <code>OVERRIDE_VIDEO_OUTPUT_DIR</code> variable should be, for
          example: <code>/root/selenoid_with_video/video</code>. The
          substitution <code>${PWD}</code> won't work here.
        </li>
        <li>
          <strong>Be sure to download the recorder once</strong>, as Selenoid
          won't download it itself and video recording won't work:
          <code>docker pull selenoid/video-recorder:latest-release</code>.
        </li>
      </ul>

      <p><strong>Passing parameters to test (Selenide/Java):</strong></p>
      <pre>
Configuration.browserCapabilities.setCapability(
    "selenoid:options",
    Map.of(
        "enableVNC", true,
        "enableLog", true,
        "enableVideo", true
    )
);</pre
      >

      <p>
        <strong>Session and video naming:</strong> you can set the test name and
        video file name by adding, for example, a timestamp. This is done in the
        test itself, it's not difficult - ask AI how to do it
      </p>
    </div>
  </body>
</html>
